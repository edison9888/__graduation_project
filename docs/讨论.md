场景相关
=======

## 基本说明 ##
**重大修改！**<br>
场景将分为两种，一种是战斗场景MCBattleFieldScene，另一种是通常的场景MCGameScene。两者都继承自MCScene。
所以场景包的格式也会分为两种。

## 包对象 ##
- id *场景ID*
- type *场景类型，1为通常场景，2为战斗场景*
- objects *场景出现的对象*
- background *tmx地图和背景音乐*
- scenes *与当前场景相连的场景*
- triggers *当前场景的触发器*

### id ###
符合规格4位字符的字符串，例如：M024

### objects ###
根据type属性的值的不同，意义不同。若为**战斗场景**，则*场景中出现的敌人，字典类型，以敌人的ID为键*，若为**一般场景**，则*场景中出现的NPC，字典类型，以NPC的ID为键*。<br>
人物都是不会走的，而怪物是随机走动的没有范围限定。<br>
以下为对象属性列表：

- requirement *出现条件，值为一个Flag的ID数组*
- x *地图中的x坐标*
- y *地图中的y坐标*

### background ###
- tmx *tmx地图的路径*
- sound *当前场景的背景音乐*

### scenes ###
一个字典，键为tmx地图中的场景标示符，值为场景ID

### triggers ###
一个字典，键为当前场景中的触发器的ID，值为lua脚本文件的路径




AI
寻路修改
任务过程
战斗控制器
信息界面显示
通常控制模式下，action键

怎么限制走动？——lua控制

ok 陷阱限制*3 
MCEffectiveItem的copy函数在android版有问题，可能其他的也有问题。

增加战场上下文：维护战场怪物的状态。

切换地图，lua控制，是否放弃任务，区域封锁

ok barrier对象，不加barrier-type则默认值是3，即陆行与飞行生物皆不予通过。

进入视野判断：
	初次发现人物。标上发现时间。若为敌人则初始化仇恨值。若皆相同的仇恨值，则取数组第一个对象。
离开视野判断：
	定时器，2秒循环迭代视野内目标检测一次是否还在视野内，不在则算是离开视野。然后更新发现时间。

flag：
ok	是否在任务中——lua控制——接任务是修改此标志
	区域封锁——lua控制——读取任务管理器，检测任务是否完成完成后修改flag为off。
	
没分AI

AI列表：

- AI01	陆行生物1
- AI02	陆行生物2
- AI03	陆行生物3
- AI04	陆行生物4
- AI11	飞行生物1   
- AI12	飞行生物2
- AI13	飞行生物3
- AI21	佣兵1
- AI22	佣兵2
- AI31	主角


AI状态：

确定攻击对象的方法——仇恨值系统

采取攻击手段的判断：
- 非战斗状态
- 战斗状态
    - 高体力值状态——进入攻击状态
    - 中体力值状态——同高体力值状态
    - 气绝状态——进入休息恢复状态，直到恢复到高体力值
    - 敌人血量评分（不科学！）
    以下只适合于佣兵
    - 贫血量状态(20%) 逃跑，离开战斗区域。
    - 
- 休息状态——
- 攻击状态 

攻击评分=攻击伤害预测值(即为攻击的最大值)+采取攻击之后的体力剩余值。（若采取攻击之后的体力剩余值为负，则忽略之）

攻击判定方式：
若有范围攻击方式，则收集范围类攻击的评分。
然后跟普通攻击评分对比。
若更佳则采用范围攻击，否则采用单体。

攻击方式判定：
自身体力值——收集所有攻击手段，若采取之，体力会在什么状态。若气绝则1分，若不则4分。
对方状态——若有异常状态则4分，若没则1分。

攻击方式有：高伤害技能、普通技能、


飞行生物：攻击敌人后，若路径没有障碍点，继续移动3格。再进入攻击方式判定。

普通生物：判定攻击目标后，若不在攻击范围内，移动到攻击范围内，继续判定攻击方式

远程生物：判定攻击目标后，若不在攻击范围内，移动到攻击范围内，若小于危险距离值（待设定），则后退到等于此值位置，


界面制作
  1. 基本界面(摇杆控制器、战斗控制器)【江宇英】
  2. [ ]状态界面(人物状态【江宇英】、任务状态【周昱志】、装备状态【周昱志】、技能状态【周昱志】、佣兵状态[有解雇的接口]【周昱志】、道具状态【周昱志】)
  3. [ ]道具买卖界面【周昱志】
  4. [ ]任务界面【周昱志】
  5. [ ]佣兵雇佣【周昱志】
  6. [ ]武器升级界面【周昱志】


